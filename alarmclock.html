<!DOCTYPE html>
<html id="bodice"  style="background-color:black; color:white">
    <head>
        <title>Alarm Clock</title>
        <script>
            var intervals = setInterval(timer, 1000), s = "notintime", n = "notintime", ns=0;
            var convertNumeralToWeekday = ["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];
            var convertNumeralToWeekdayC = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
            var convertNumeralToColour = ["black","white","blue","cyan","green","red","orange","purple","gray"]
            var sessionID = location.search;
            function setCookie(cname, cvalue, exdays) {
                localStorage.setItem(sessionID+cname,cvalue);
            }
            
            function getCookie(cname) {
                if(localStorage.getItem(sessionID+cname)==null)return "";
                else return localStorage.getItem(sessionID+cname);
            }
            
            function deleteCookie( name ) {
                localStorage.removeItem(sessionID+name);
            }
            
            function loadsettings(){
                
                var time = getCookie("timex");
                if(time!=""){
                    s = time;
                    n = s;
                    document.getElementById("alarm").value=time;
                    document.getElementById("clocker").innerHTML = "";
                    for(var i=0; i<7; i++){
                        if(getCookie(convertNumeralToWeekday[i])==1)document.getElementById(convertNumeralToWeekday[i]).checked=true;
                        else document.getElementById(convertNumeralToWeekday[i]).checked=false;
                    }
                    document.getElementById("repeat").value="Reoccuring"
                    document.getElementById("customsched").style.display="block";
                }
                var bgcolor=getCookie("bgcolor"),fgcolor=getCookie("fgcolor"),accolor=getCookie("accolor");
                if(bgcolor!=""){
                    document.getElementById("bgcolor").selectedIndex = bgcolor;
                    bgcolorchange();
                }
                if(fgcolor!=""){
                    document.getElementById("fgcolor").selectedIndex = fgcolor;
                    fgcolorchange();
                }
                if(accolor!=""){
                    document.getElementById("accolor").selectedIndex = accolor;
                    accolorchange();
                }
            }
            
            function savesettings(){
                setCookie("timex",s,1000000);
                for(var i=0; i<7; i++){
                        if(document.getElementById(convertNumeralToWeekday[i]).checked)setCookie(convertNumeralToWeekday[i],1,1000000);
                        else setCookie(convertNumeralToWeekday[i],0,1000000);
                }
            }
            
            function deletesettings(){
                deleteCookie("timex");
                for(var i=0; i<7; i++)deleteCookie(convertNumeralToWeekday[i]);
            }
            
            function timer() {
                var d = new Date();
                document.getElementById("timecontrol").innerHTML=d.toTimeString().substr(0,9);
                document.getElementById("datecontrol").innerHTML=d.toDateString();
                if(d.toTimeString().indexOf(s)>-1 && ((document.getElementById("repeat").value=="Isolated") || (document.getElementById(convertNumeralToWeekday[d.getDay()]).checked) )){
                    alarmactivate();
                }
                delete d;
            }
            function alarmconfiguration(){
               s = document.getElementById("alarm").value;
               if(s.length<8)s+=":00";
               n = s;
               if(document.getElementById("repeat").value=="Reoccuring")savesettings();
            }
            
            function alarmreset(){
                s = "notintime";
                deletesettings();
                document.getElementById("clocker").innerHTML="";
            }
            
            function alarmcontrols(){
                s = n;
                document.getElementById("alarmsound").load();
                document.getElementById("alarmcontrols").style.display="none";
                if(document.getElementById("repeat").value=="Isolated")alarmreset();
                document.getElementById("clocker").innerHTML="";
            }
            
            function alarmactivate(){
                n = s;
                document.getElementById("alarmsound").play();
                document.getElementById("alarmcontrols").style.display="block";
                document.getElementById("clocker").innerHTML="";
            }
            
            function alarmsnooze(){
                document.getElementById("alarmsound").load();
                ns+=15;
                var h=s.split(":");
                var hh = parseInt(h[0]),mm=parseInt(h[1]);
                mm+=15;
                if(mm>60){
                    mm%=60;
                    hh++;
                }
                if(hh>=24){
                    hh%=24;
                }
                h[0]="";
                if(hh<10)h[0]="0";
                h[0]+=hh.toString();
                h[1]="";
                if(mm<10)h[1]="0";
                h[1]+=mm.toString();
                s=h[0]+":"+h[1]+":"+h[2];
                delete h,hh,mm;
                document.getElementById("clocker").innerHTML = "<br />Snoozing for " + ns + " minutes. <input type=\"button\" onclick=\"alarmcontrols()\" value=\"Stop\"  />";
                document.getElementById("alarmcontrols").style.display="none";
            }
            
            function repeattoggle(){
                if(document.getElementById("repeat").value=="Reoccuring"){
                    document.getElementById("repeat").value="Isolated"
                    document.getElementById("customsched").style.display="none";
                }
                else { 
                    document.getElementById("repeat").value="Reoccuring"
                    document.getElementById("customsched").style.display="block";
                }
            }
            
            function bgcolorchange(){
                document.getElementById("bodice").style.color=convertNumeralToColour[document.getElementById("bgcolor").selectedIndex] ;
                setCookie("bgcolor",document.getElementById("bgcolor").selectedIndex,1);
            }
            function fgcolorchange(){
                document.getElementById("bodice").style.backgroundColor=convertNumeralToColour[document.getElementById("fgcolor").selectedIndex] ;
                setCookie("fgcolor",document.getElementById("fgcolor").selectedIndex,1);
            }
            function accolorchange(){
                for(var i=0; i<document.getElementsByClassName("checkboxclass").length; i++){
                    document.getElementsByClassName("checkboxclass")[i].style.color=convertNumeralToColour[document.getElementById("accolor").selectedIndex] ;
                }
                setCookie("accolor",document.getElementById("accolor").selectedIndex,1);
            }
        </script>
        <style>
            * 
            {
                text-align:center;
                background-color:inherit;
                color:inherit;
                border:none;
            }
            .checkboxclass
            {
                border:none;
                color:cyan;
                font-size:1em;
            }
            input[type="checkbox"] {
                display:none;
            }
            input[type="checkbox"] + label span {
            }
            input[type="checkbox"]:checked + label span {
                border:1px solid;
                padding : 0.25em 0.25em 0.25em 0.25em;
            }
            .pagination
            {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
            }
            #timecontrol{
                font-size:4em;
            }
        </style>
    </head>
    
    <body onload="loadsettings()">
        <audio hidden id="alarmsound">
            <source src="alarme.m4a" type="audio/mpeg"/>
        </audio>
        <div class="pagination">
            <span id="alarmcontrols" style="display:none">
                <span>Alarm ringing!!!</span>
                <input type="button" onclick="alarmcontrols()" value="Stop"  />
                <input type="button" onclick="alarmsnooze()" value="Snooze"  />
                <br />
            </span>
            <span id="clocker"  ></span><br />
            
            <span id="timecontrol" style="text-align:left"> </span> <br />
            <span id="datecontrol" style="text-align:left"> </span> <br /><br />
            <input type="time" step="1" id="alarm" class="checkboxclass"/><input type="button" onclick="repeattoggle()" value="Isolated" id="repeat" class="checkboxclass"/> <input type="button" onclick="alarmreset()" value="Reset" class="checkboxclass"/>
                <input type="button" onclick="alarmconfiguration()" value="Apply"  class="checkboxclass"/><br /><br />
            
                <div id="customsched" style="display:none">
                    <input type="checkbox" id="sunday" class="checkboxclass"/><label class="checkboxclass" for="sunday"><span>SUN</span></label>
                    <input type="checkbox" id="monday" class="checkboxclass"/><label class="checkboxclass" for="monday"><span>MON</span></label>
                    <input type="checkbox" id="tuesday" class="checkboxclass"/><label class="checkboxclass" for="tuesday"><span>TUE</span></label>
                    <input type="checkbox" id="wednesday" class="checkboxclass"/><label class="checkboxclass" for="wednesday"><span>WED</span></label>
                    <input type="checkbox" id="thursday" class="checkboxclass"/><label class="checkboxclass" for="thursday"><span>THU</span></label>
                    <input type="checkbox" id="friday" class="checkboxclass"/><label class="checkboxclass" for="friday"><span>FRI</span></label>
                    <input type="checkbox" id="saturday" class="checkboxclass"/><label class="checkboxclass" for="saturday"><span>SAT</span></label><br />
                    
                </div>
                
        </div>
        <div id="theming"> 
            <select id="fgcolor" onchange="fgcolorchange()" class="checkboxclass" selectedIndex="0">
                <option>Black</option>
                <option>White</option>
                <option>Blue</option>
                <option>Cyan</option>
                <option>Green</option>
                <option>Red</option>
                <option>Orange</option>
                <option>Purple</option>
                <option>Gray</option>
            </select>
            <select id="bgcolor" onchange="bgcolorchange()" class="checkboxclass" selectedIndex="1">
                <option>Black</option>
                <option>White</option>
                <option>Blue</option>
                <option>Cyan</option>
                <option>Green</option>
                <option>Red</option>
                <option>Orange</option>
                <option>Purple</option>
                <option>Gray</option>
            </select>
            <select id="accolor" onchange="accolorchange()" class="checkboxclass" selectedIndex="3">
                <option>Black</option>
                <option>White</option>
                <option>Blue</option>
                <option>Cyan</option>
                <option>Green</option>
                <option>Red</option>
                <option>Orange</option>
                <option>Purple</option>
                <option>Gray</option>
            </select>
        </div>
    </body>
</html>
